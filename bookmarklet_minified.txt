javascript:(()=>{const e=window.location.hostname,t=window.location.href;let n="",r="",o="";if(e.includes("chatgpt.com")){o="ChatGPT";const e=document.querySelectorAll(".user-message-bubble-color"),t=document.querySelectorAll("div[data-message-author-role='assistant']");if(e.length>0){const r=Array.from(e),o=Array.from(t);for(let e=0;e<Math.max(r.length,o.length);e++){if(e<r.length){const t=(r[e].textContent||"").trim();t&&(n+=`---\n### User\n\n${t}\n\n`)}if(e<o.length){const t=(o[e].textContent||"").trim();t&&(n+=`### Assistant\n\n${t}\n\n`)}}}else{const e=document.querySelectorAll("div[data-message-author-role]"),t=Array.from(e);for(let e=0;e<t.length;e++){const r=t[e];if("user"===r.getAttribute("data-message-author-role")){const o=r.querySelector(".whitespace-pre-wrap"),s=o?(o.innerText||o.textContent||"").trim():(r.textContent||"").trim();s&&(n+=`---\n### User\n\n${s}\n\n`);let c="",l=e+1;for(;l<t.length&&"user"!==t[l].getAttribute("data-message-author-role");){const e=(t[l].textContent||"").trim();e&&(c+=e+"\n\n"),l++}c.trim()&&(n+=`### Assistant\n\n${c.trim()}\n\n`),e=l-1}}}r=document.title.replace(/[^\w\d\s]+/g,"").replace(/\s+/g,"_").replace(/^_+|_+$/g,"").slice(0,60)}else if(e.includes("perplexity.ai"))o="Perplexity",document.querySelectorAll("h1").forEach(e=>{const t=e.textContent.trim();n+=`---\n### User\n\n${t}\n\n`;let r="",o=e;for(let e=0;e<15&&o&&(o=o.parentElement,o);e++){const e=o.textContent.indexOf("Answer");if(e>-1){const t=o.textContent.substring(e+6),n=t.indexOf("Share");r=n>-1?t.substring(0,n).trim():t.substring(0,3e3).trim();break}}r&&(r=r.replace(/^(Sources|Steps|Answer).*?\n/,"").replace(/SourcesÂ·.*?Steps/,"").replace(/^\s+/,"").replace(/\n{3,}/g,"\n\n"),n+=`### Assistant\n\n${r}\n\n`)}),r=document.title.replace(/[^\w\d\s]+/g,"").replace(/\s+/g,"_").replace(/^_+|_+$/g,"").slice(0,60);else if(e.includes("deepseek.com")){o="DeepSeek";document.querySelectorAll("div.fbb737a4, div.ds-markdown").forEach(e=>{const t=e.classList.contains("fbb737a4")?"### User":"### Assistant",r=e.innerText.trim();r&&(n+=`${t}\n\n${r}\n\n---\n\n`)}),r=document.title.replace(" - DeepSeek","").trim().replace(/[^\w\d\s]+/g,"").replace(/\s+/g,"_").replace(/^_+|_+$/g,"").slice(0,60)}else if(e.includes("openrouter.ai")){o="OpenRouter";const e=document.body.innerText.split("\n").map(e=>e.trim()).filter(e=>e);let t="",s=0;for(;s<e.length;){const r=e[s];if("Chris"===r||"User"===r){if(s++,s<e.length){const r=e[s];for(t||(t=r.substring(0,60)),n+=`---\n### User\n\n${r}\n\n`,s++;s<e.length&&e[s].match(/(minute|hour|day|month)s? ago/);)s++}}else if(r.match(/.*(free|paid)\)$/)||"Deleted"===r){if(n+=`### Assistant (${"Deleted"===r?"Assistant":r})\n\n`,s++,e[s]?.startsWith("Reasoning")){for(n+=`**${e[s]}**\n\n`,s+=2;s<e.length&&"Collapse reasoning"!==e[s];)n+=e[s]+"\n\n",s++;s++}let t="";for(;s<e.length&&!e[s].match(/(minute|hour|day|month)s? ago/)&&"Chris"!==e[s]&&"User"!==e[s]&&!e[s].match(/.*(free|paid)\)$/)&&"Deleted"!==e[s];)t+=e[s]+"\n\n",s++;for(t&&(n+=t);s<e.length&&e[s].match(/(minute|hour|day|month)s? ago/);)s++}else s++}r=t.replace(/[^\w\d\s]+/g,"").replace(/\s+/g,"_").replace(/^_+|_+$/g,"").slice(0,60)||"openrouter_chat"}else if(e.includes("claude.ai")){o="Claude";document.querySelectorAll("div[data-test-render-count]").forEach(e=>{const t=e.closest('[class*="font-user"]')?"### User":"### Assistant",r=e.innerText.trim();r&&(n+=`---\n${t}\n\n${r}\n\n`)}),r=document.title.replace(/[^\w\d\s]+/g,"").replace(/\s+/g,"_").replace(/^_+|_+$/g,"").slice(0,60)}else if(e.includes("gemini.google.com")){o="Gemini";document.querySelectorAll(".conversation-container").forEach(e=>{const t=e.querySelector("user-query"),r=e.querySelector("model-response");if(t){const e=t.innerText?.trim();e&&(n+=`---\n### User\n\n${e}\n\n`)}if(r){let e=r.innerText?.trim();e&&(e.startsWith("Show thinking")&&(e=e.replace(/^Show thinking\s*/,"")),n+=`### Assistant\n\n${e}\n\n`)}});const e=document.querySelector('.conversation.active, .conversation.selected, .conversation[aria-current="page"]'),t=e?.querySelector(".conversation-title")?.textContent?.trim();r=(t||document.title).replace(/[^\w\d\s]+/g,"").replace(/\s+/g,"_").replace(/^_+|_+$/g,"").slice(0,60)||"gemini_chat"}else{if(!e.includes("aistudio.google.com"))return void alert("Unsupported chat site. Supported: ChatGPT, Perplexity, DeepSeek, OpenRouter, Claude, Gemini, Google AI Studio");{o="Google AI Studio";document.querySelectorAll(".chat-turn-container").forEach(e=>{const t=e.classList.contains("user"),r=e.classList.contains("model");if(t||r){const r=t?"### User":"### Assistant";let o=(e.textContent||"").trim();o=o.replace(/^(edit|more_vert|User|Model|Thoughts|Expand to view model thoughts|chevron_right|content_copy|thumb_up|thumb_down|flag|share)+\s*/g,"").replace(/\s+(edit|more_vert|content_copy|thumb_up|thumb_down|flag|share)\s*$/g,"").replace(/Google Search Suggestions.*$/s,"").trim(),o&&(n+=`---\n${r}\n\n${o}\n\n`)}});const e=document.querySelector("h1")?.textContent?.trim();r=(e||document.title).replace(/[^\w\d\s]+/g,"").replace(/\s+/g,"_").replace(/^_+|_+$/g,"").slice(0,60)||"ai_studio_chat"}}if(!n)return void alert("No conversation found to export");const s=new Blob([`[${o}](${t})\n\n${n}`],{type:"text/markdown"}),c=document.createElement("a");c.href=URL.createObjectURL(s),c.download=`${r||"chat_export"}.md`,c.click()})();