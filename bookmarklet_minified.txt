javascript:(()=>{const e=window.location.hostname,t=window.location.href;let n="",r="",s="";if(e.includes("chatgpt.com")){s="ChatGPT";const e=document.querySelectorAll(".user-message-bubble-color"),t=document.querySelectorAll("div[data-message-author-role='assistant']");if(e.length>0){const r=Array.from(e),s=Array.from(t);for(let e=0;e<Math.max(r.length,s.length);e++){if(e<r.length){const t=(r[e].textContent||"").trim();t&&(n+=`---\n### User\n\n${t}\n\n`)}if(e<s.length){const t=(s[e].textContent||"").trim();t&&(n+=`### Assistant\n\n${t}\n\n`)}}}else{const e=document.querySelectorAll("div[data-message-author-role]"),t=Array.from(e);for(let e=0;e<t.length;e++){const r=t[e];if("user"===r.getAttribute("data-message-author-role")){const s=r.querySelector(".whitespace-pre-wrap"),o=s?(s.innerText||s.textContent||"").trim():(r.textContent||"").trim();o&&(n+=`---\n### User\n\n${o}\n\n`);let a="",c=e+1;for(;c<t.length&&"user"!==t[c].getAttribute("data-message-author-role");){const e=(t[c].textContent||"").trim();e&&(a+=e+"\n\n"),c++}a.trim()&&(n+=`### Assistant\n\n${a.trim()}\n\n`),e=c-1}}}r=document.title.replace(/[^\w\d\s]+/g,"").replace(/\s+/g,"_").replace(/^_+|_+$/g,"").slice(0,60)}else if(e.includes("perplexity.ai")){s="Perplexity";const e=window.location.pathname.match(/\/search\/([^/?]+)/),o=e?e[1]:null;if(o)return void(async()=>{try{const e=await fetch(`/rest/thread/${o}`,{credentials:"include"});if(!e.ok)throw new Error(`API returned ${e.status}`);const a=await e.json();(a.entries||[]).forEach(e=>{try{const t=JSON.parse(e.text),r=t.find(e=>"INITIAL_QUERY"===e.step_type)?.content?.query,s=t.find(e=>"FINAL"===e.step_type)?.content?.answer;if(r&&(n+=`---\n### User\n\n${r}\n\n`),s)try{const e=JSON.parse(s);e.answer&&(n+=`### Assistant\n\n${e.answer}\n\n`)}catch{n+=`### Assistant\n\n${s}\n\n`}}catch{}}),r=document.title.replace(/[^\w\d\s]+/g,"").replace(/\s+/g,"_").replace(/^_+|_+$/g,"").slice(0,60);const c=`[${s}](${t})\n\n${n}`,l=new Blob([c],{type:"text/markdown"}),i=document.createElement("a");i.href=URL.createObjectURL(l),i.download=`${r||"chat_export"}.md`,i.click()}catch(e){alert(`Failed to fetch Perplexity thread: ${e.message}`)}})();const a=document.querySelectorAll('[class*="group/query"]'),c=document.querySelectorAll('div[class*="prose dark:prose-invert inline leading-relaxed"]');a.forEach((e,t)=>{const r=e.textContent?.trim();if(r&&(n+=`---\n### User\n\n${r}\n\n`,t<c.length)){let e=c[t].innerText?.trim()||"";e=e.replace(/^(Sources|Reviewed \d+ sources?)\s*/gi,"").replace(/\n{3,}/g,"\n\n").trim(),e&&(n+=`### Assistant\n\n${e}\n\n`)}}),r=document.title.replace(/[^\w\d\s]+/g,"").replace(/\s+/g,"_").replace(/^_+|_+$/g,"").slice(0,60)}else if(e.includes("deepseek.com")){s="DeepSeek";document.querySelectorAll("div.fbb737a4, div.ds-markdown").forEach(e=>{const t=e.classList.contains("fbb737a4")?"### User":"### Assistant",r=e.innerText.trim();r&&(n+=`${t}\n\n${r}\n\n---\n\n`)}),r=document.title.replace(" - DeepSeek","").trim().replace(/[^\w\d\s]+/g,"").replace(/\s+/g,"_").replace(/^_+|_+$/g,"").slice(0,60)}else if(e.includes("openrouter.ai")){s="OpenRouter";const e=document.body.innerText.split("\n").map(e=>e.trim()).filter(e=>e);let t="",o=0;for(;o<e.length;){const r=e[o];if("Chris"===r||"User"===r){if(o++,o<e.length){const r=e[o];for(t||(t=r.substring(0,60)),n+=`---\n### User\n\n${r}\n\n`,o++;o<e.length&&e[o].match(/(minute|hour|day|month)s? ago/);)o++}}else if(r.match(/.*(free|paid)\)$/)||"Deleted"===r){if(n+=`### Assistant (${"Deleted"===r?"Assistant":r})\n\n`,o++,e[o]?.startsWith("Reasoning")){for(n+=`**${e[o]}**\n\n`,o+=2;o<e.length&&"Collapse reasoning"!==e[o];)n+=e[o]+"\n\n",o++;o++}let t="";for(;o<e.length&&!e[o].match(/(minute|hour|day|month)s? ago/)&&"Chris"!==e[o]&&"User"!==e[o]&&!e[o].match(/.*(free|paid)\)$/)&&"Deleted"!==e[o];)t+=e[o]+"\n\n",o++;for(t&&(n+=t);o<e.length&&e[o].match(/(minute|hour|day|month)s? ago/);)o++}else o++}r=t.replace(/[^\w\d\s]+/g,"").replace(/\s+/g,"_").replace(/^_+|_+$/g,"").slice(0,60)||"openrouter_chat"}else if(e.includes("claude.ai")){s="Claude";document.querySelectorAll("div[data-test-render-count]").forEach(e=>{const t=e.closest('[class*="font-user"]')?"### User":"### Assistant",r=e.innerText.trim();r&&(n+=`---\n${t}\n\n${r}\n\n`)}),r=document.title.replace(/[^\w\d\s]+/g,"").replace(/\s+/g,"_").replace(/^_+|_+$/g,"").slice(0,60)}else if(e.includes("gemini.google.com")){s="Gemini";document.querySelectorAll(".conversation-container").forEach(e=>{const t=e.querySelector("user-query"),r=e.querySelector("model-response");if(t){const e=t.innerText?.trim();e&&(n+=`---\n### User\n\n${e}\n\n`)}if(r){let e=r.innerText?.trim();e&&(e.startsWith("Show thinking")&&(e=e.replace(/^Show thinking\s*/,"")),n+=`### Assistant\n\n${e}\n\n`)}});const e=document.querySelector('.conversation.active, .conversation.selected, .conversation[aria-current="page"]'),t=e?.querySelector(".conversation-title")?.textContent?.trim();r=(t||document.title).replace(/[^\w\d\s]+/g,"").replace(/\s+/g,"_").replace(/^_+|_+$/g,"").slice(0,60)||"gemini_chat"}else if(e.includes("aistudio.google.com")){s="Google AI Studio";document.querySelectorAll(".chat-turn-container").forEach(e=>{const t=e.classList.contains("user"),r=e.classList.contains("model");if(t||r){const r=t?"### User":"### Assistant";let s=(e.textContent||"").trim();s=s.replace(/^(edit|more_vert|User|Model|Thoughts|Expand to view model thoughts|chevron_right|content_copy|thumb_up|thumb_down|flag|share)+\s*/g,"").replace(/\s+(edit|more_vert|content_copy|thumb_up|thumb_down|flag|share)\s*$/g,"").replace(/Google Search Suggestions.*$/s,"").trim(),s&&(n+=`---\n${r}\n\n${s}\n\n`)}});const e=document.querySelector("h1")?.textContent?.trim();r=(e||document.title).replace(/[^\w\d\s]+/g,"").replace(/\s+/g,"_").replace(/^_+|_+$/g,"").slice(0,60)||"ai_studio_chat"}else if(e.includes("x.com")||e.includes("twitter.com")){s="X";const e=document.querySelectorAll('article[data-testid="tweet"]');let t="",o="";e.forEach((e,r)=>{const s=e.querySelector('[data-testid="User-Name"]'),a=s?Array.from(s.querySelectorAll('a[href^="/"]')):[];let c="";for(const e of a){const t=e.getAttribute("href");if(t&&t.startsWith("/")&&!t.includes("/status/")&&t.length>1){c=t;break}}const l=s?.querySelector("span span")?.textContent||"",i=e.querySelector('[data-testid="tweetText"]'),d=i?.innerText||"",u=e.querySelector("time")?.getAttribute("datetime")||"",m=u?new Date(u).toLocaleString():"",p=Array.from(e.querySelectorAll("img")).map(e=>e.src).filter(e=>e&&e.includes("pbs.twimg.com")&&!e.includes("profile_images")&&!e.includes("emoji")),g=e.querySelector('[data-testid="card.wrapper"] a')?.href||"";0===r&&(t=c,o=d.substring(0,60));n+=`---\n### ${c===t?`**${l}** (${c})`:`**${l}** (${c}) â€” Reply`}\n`,m&&(n+=`*${m}*\n\n`),n+=`${d}\n\n`,p.length>0&&p.forEach((e,t)=>{const r=e.replace("name=small","name=large");n+=`![Image ${t+1}](${r})\n\n`}),g&&(n+=`ðŸ”— [Link](${g})\n\n`)}),r=(o||document.title).replace(/[^\w\d\s]+/g,"").replace(/\s+/g,"_").replace(/^_+|_+$/g,"").slice(0,60)||"x_thread"}else{if(!e.includes("grok.com"))return e.includes("web.whatsapp.com")?(s="WhatsApp",void(async()=>{try{const e=[],n=new Set,r=()=>{document.querySelectorAll("[data-pre-plain-text]").forEach(t=>{const r=t.getAttribute("data-pre-plain-text")||"",s=t.querySelector(".copyable-text, [class*='copyable-text']"),o=(s?.innerText||t.innerText||"").trim(),a=t.closest('[class*="message-"]'),c=a?.classList.toString().includes("message-out")||!1,l=r+"|||"+o.substring(0,50);n.has(l)||(n.add(l),e.push({timestamp:r,text:o,isOutgoing:c}))})},o=(e,t)=>{const n=document.createElement("div");return n.textContent=e,n.style.cssText="position:fixed;bottom:20px;left:50%;transform:translateX(-50%);background:#333;color:#fff;padding:12px 24px;border-radius:8px;z-index:999999;font-family:sans-serif;font-size:14px;",document.body.appendChild(n),t&&setTimeout(()=>n.remove(),t),n},a=async(e,t)=>{const n=Date.now();let r=e.scrollHeight;for(;Date.now()-n<t;)if(await new Promise(e=>setTimeout(e,100)),e.scrollHeight!==r)r=e.scrollHeight;else if(Date.now()-n>300)break},c=(()=>Array.from(document.querySelectorAll("div")).filter(e=>{const t=window.getComputedStyle(e);return"auto"===t.overflowY||"scroll"===t.overflowY}).find(e=>e.querySelector("[data-pre-plain-text]")))();if(!c)return void alert("Could not find WhatsApp message container. Make sure a chat is open.");const l=document.querySelector('[aria-selected="true"]'),i=l?.innerText?.split("\n")[0]||"WhatsApp_Chat",d=o("Scrolling to top...");let u=0,m=0;for(;m<5&&(c.scrollTop=0,await a(c,2e3),c.scrollHeight===u?m++:(u=c.scrollHeight,m=0),!(0===c.scrollTop&&m>=2)););r();const p=600,g=50;let h=0;for(;h<5e3;){const t=c.scrollTop,n=c.scrollHeight-c.clientHeight;if(h%g===0&&(d.textContent="Capturing... "+e.length+" messages"),c.scrollTop=Math.min(t+p,n),await a(c,2e3),r(),h++,c.scrollTop>=n-10){await new Promise(e=>setTimeout(e,500)),r();break}}d.remove();let f="";e.forEach(e=>{let t="Other";if(e.isOutgoing)t="You";else{const n=e.timestamp.match(/\]\s*([^:]+):/);n&&(t=n[1].trim())}f+="---\n### "+t+"\n*"+e.timestamp.trim()+"*\n\n"+e.text+"\n\n"});const y="whatsapp-"+i.replace(/[^\w\d\s]+/g,"").replace(/\s+/g,"_").replace(/^_+|_+$/g,"").slice(0,60),w=new Blob(["["+s+"]("+t+")\n\n"+f],{type:"text/markdown"}),x=document.createElement("a");x.href=URL.createObjectURL(w),x.download=y+".md",x.click(),o("Exported "+e.length+" messages from "+i,3e3)}catch(e){alert("Error exporting WhatsApp chat: "+e.message)}})()):void alert("Unsupported site. Supported: ChatGPT, Perplexity, DeepSeek, OpenRouter, Claude, Gemini, Google AI Studio, X.com, Grok, WhatsApp");{s="Grok";const e=document.querySelectorAll(".message-bubble");let t="";e.forEach(e=>{const r=e.innerText?.trim();if(!r||r.length<20)return;const s=e.classList.contains("bg-surface-l1")||e.closest('[class*="items-end"]'),o=s?"User":"Assistant";s&&!t&&(t=r.substring(0,60)),n+=`---\n### ${o}\n\n${r}\n\n`}),r=(t||document.title).replace(/[^\w\d\s]+/g,"").replace(/\s+/g,"_").replace(/^_+|_+$/g,"").slice(0,60)||"grok_chat"}}if(!n)return void alert("No conversation found to export");const o=new Blob([`[${s}](${t})\n\n${n}`],{type:"text/markdown"}),a=document.createElement("a");a.href=URL.createObjectURL(o),a.download=`${r||"chat_export"}.md`,a.click()})();