Keeping a "save as markdown" link on my toolbar so I can keep local copies of my AI chats.

ðŸ“—.md

Supports: ChatGPT, Perplexity, DeepSeek, OpenRouter, Claude, and Gemini!



javascript:(()=>{const e=window.location.hostname,t=window.location.href;let n="",r="",s="";if(e.includes("chatgpt.com")){s="ChatGPT";const e=document.querySelectorAll("div[data-message-author-role]"),t=Array.from(e);for(let e=0;e<t.length;e++){const r=t[e];if("user"===r.getAttribute("data-message-author-role")){const s=r.querySelector(".whitespace-pre-wrap"),o=s?(s.innerText||s.textContent||"").trim():(r.textContent||"").trim();o&&(n+=`---\n### User\n\n${o}\n\n`);let i="",c=e+1;for(;c<t.length&&"user"!==t[c].getAttribute("data-message-author-role");){const e=(t[c].textContent||"").trim();e&&(i+=e+"\n\n"),c++}i.trim()&&(n+=`### Assistant\n\n${i.trim()}\n\n`),e=c-1}}r=document.title.replace(/[^\w\d\s]+/g,"").replace(/\s+/g,"_").replace(/^_+|_+$/g,"").slice(0,60)}else if(e.includes("perplexity.ai"))s="Perplexity",document.querySelectorAll("h1").forEach(e=>{const t=e.textContent.trim();n+=`---\n### User\n\n${t}\n\n`;let r="",s=e;for(let e=0;e<15&&s&&(s=s.parentElement,s);e++){const e=s.textContent.indexOf("Answer");if(e>-1){const t=s.textContent.substring(e+6),n=t.indexOf("Share");r=n>-1?t.substring(0,n).trim():t.substring(0,3e3).trim();break}}r&&(r=r.replace(/^(Sources|Steps|Answer).*?\n/,"").replace(/SourcesÂ·.*?Steps/,"").replace(/^\s+/,"").replace(/\n{3,}/g,"\n\n"),n+=`### Assistant\n\n${r}\n\n`)}),r=document.title.replace(/[^\w\d\s]+/g,"").replace(/\s+/g,"_").replace(/^_+|_+$/g,"").slice(0,60);else if(e.includes("deepseek.com")){s="DeepSeek";document.querySelectorAll("div.fbb737a4, div.ds-markdown").forEach(e=>{const t=e.classList.contains("fbb737a4")?"### User":"### Assistant",r=e.innerText.trim();r&&(n+=`${t}\n\n${r}\n\n---\n\n`)}),r=document.title.replace(" - DeepSeek","").trim().replace(/[^\w\d\s]+/g,"").replace(/\s+/g,"_").replace(/^_+|_+$/g,"").slice(0,60)}else if(e.includes("openrouter.ai")){s="OpenRouter";const e=document.body.innerText.split("\n").map(e=>e.trim()).filter(e=>e);let t="",o=0;for(;o<e.length;){const r=e[o];if("Chris"===r||"User"===r){if(o++,o<e.length){const r=e[o];for(t||(t=r.substring(0,60)),n+=`---\n### User\n\n${r}\n\n`,o++;o<e.length&&e[o].match(/(minute|hour|day|month)s? ago/);)o++}}else if(r.match(/.*(free|paid)\)$/)||"Deleted"===r){if(n+=`### Assistant (${"Deleted"===r?"Assistant":r})\n\n`,o++,e[o]?.startsWith("Reasoning")){for(n+=`**${e[o]}**\n\n`,o+=2;o<e.length&&"Collapse reasoning"!==e[o];)n+=e[o]+"\n\n",o++;o++}let t="";for(;o<e.length&&!e[o].match(/(minute|hour|day|month)s? ago/)&&"Chris"!==e[o]&&"User"!==e[o]&&!e[o].match(/.*(free|paid)\)$/)&&"Deleted"!==e[o];)t+=e[o]+"\n\n",o++;for(t&&(n+=t);o<e.length&&e[o].match(/(minute|hour|day|month)s? ago/);)o++}else o++}r=t.replace(/[^\w\d\s]+/g,"").replace(/\s+/g,"_").replace(/^_+|_+$/g,"").slice(0,60)||"openrouter_chat"}else if(e.includes("claude.ai")){s="Claude";document.querySelectorAll("div[data-test-render-count]").forEach(e=>{const t=e.closest('[class*="font-user"]')?"### User":"### Assistant",r=e.innerText.trim();r&&(n+=`---\n${t}\n\n${r}\n\n`)}),r=document.title.replace(/[^\w\d\s]+/g,"").replace(/\s+/g,"_").replace(/^_+|_+$/g,"").slice(0,60)}else{if(!e.includes("gemini.google.com"))return void alert("Unsupported chat site. Supported: ChatGPT, Perplexity, DeepSeek, OpenRouter, Claude, Gemini");{s="Gemini";document.querySelectorAll(".conversation-container").forEach(e=>{const t=e.querySelector("user-query"),r=e.querySelector("model-response");if(t){const e=t.innerText?.trim();e&&(n+=`---\n### User\n\n${e}\n\n`)}if(r){let e=r.innerText?.trim();e&&(e.startsWith("Show thinking")&&(e=e.replace(/^Show thinking\s*/,"")),n+=`### Assistant\n\n${e}\n\n`)}});const e=document.querySelector('.conversation.active, .conversation.selected, .conversation[aria-current="page"]'),t=e?.querySelector(".conversation-title")?.textContent?.trim();r=(t||document.title).replace(/[^\w\d\s]+/g,"").replace(/\s+/g,"_").replace(/^_+|_+$/g,"").slice(0,60)||"gemini_chat"}}if(!n)return void alert("No conversation found to export");const o=new Blob([`[${s}](${t})\n\n${n}`],{type:"text/markdown"}),i=document.createElement("a");i.href=URL.createObjectURL(o),i.download=`${r||"chat_export"}.md`,i.click()})();


# sep

